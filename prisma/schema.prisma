// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Settings {
  id          String   @id @default(uuid())
  key         String   @unique
  value       String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Actor {
  id          String   @id
  name        String
  image_path  String
  rating      Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}


// Prisma schema for playlist support (manual + smart playlists with clip times)

enum PlaylistType {
  MANUAL
  SMART
}

model Playlist {
  id           String          @id @default(uuid())
  name         String
  description  String?
  type         PlaylistType    @default(MANUAL)

  // For manual playlists: explicit items ordering and clip definitions
  items        PlaylistItem[]

  // For smart playlists: JSON-based conditions (e.g. filter rules)
  conditions   Json?

  // Metadata
  createdAt    DateTime        @default(now())
  updatedAt    DateTime        @updatedAt
}

model PlaylistItem {
  id          String      @id @default(uuid())
  playlist    Playlist    @relation(fields: [playlistId], references: [id])
  playlistId  String

  // Reference to your existing Item model
  item        Item        @relation(fields: [itemId], references: [id])
  itemId      String

  // Ordering of items in manual playlists
  itemOrder   Int

  @@index([playlistId, itemOrder])
}

// Define the Item model if not already present in your schema
model Item {
  id           String      @id
  title        String
  startTime    Float       @default(0)
  endTime      Float       @default(0)
  screenshot   String?
  stream       String?

  // Relations
  playlists    PlaylistItem[]  
}